---
import type { HTMLAttributes } from 'astro/types';

import { getElementAttributes } from '@/utils/get-element-attributes';
import { removeTopElement } from '@/utils/remove-top-element';

interface Props extends HTMLAttributes<'svg'> {
  name: string;
}

const { name, ...props } = Astro.props;

const [set, icon] = name.split(':');

const svg = await fetch(`https://api.iconify.design/${set}/${icon}.svg`).then((res) => res.text());
const args = getElementAttributes(svg);
const content = removeTopElement(svg);
---

<svg {...args} {...props}><Fragment set:html={content} /></svg>
