---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';

import { markdownToHtml } from '@/utils/markdown-to-html';
import { removeTopElement } from '@/utils/remove-top-element';

import Linkable from './linkable.astro';
import RenderedContent from './rendered-content.astro';

interface Props {
  referenceEntry: CollectionEntry<'references'>;
}

const {
  referenceEntry: { data, body, render },
} = Astro.props;

const { author } = data;

const role = author.role && removeTopElement(markdownToHtml(author.role));
const relation = author.relation && removeTopElement(markdownToHtml(author.relation));
---

<div class="flex flex-col gap-6">
  {body.trim().length > 0 && <RenderedContent render={render} />}
  <div class="flex gap-4">
    {author.image && <Image class="size-14 rounded-full" src={author.image} alt={author.name} width={96} height={96} />}
    <div class="self-center">
      <Linkable class="text-base font-bold text-slate-900 sm:text-lg" href={author.url}>{author.name}</Linkable>
      {role && <div class="text-sm font-medium text-slate-900 sm:text-base" set:html={role} />}
      {relation && <div class="text-sm font-normal text-slate-700 sm:text-base" set:html={relation} />}
    </div>
  </div>
</div>
