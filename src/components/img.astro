---
import type { LocalImageProps, RemoteImageProps } from 'astro:assets';
import { Image } from 'astro:assets';

import type { ContextSlice } from '@/types/context';
import { getGlobalContext } from '@/utils/get-global-context';

type Props = Omit<LocalImageProps | RemoteImageProps, 'src'> & {
  src: LocalImageProps['src'] | RemoteImageProps['src'];
};

const context = getGlobalContext<ContextSlice<'type'>>(Astro, { optional: true });

const { loading = context?.type === 'web' ? 'lazy' : 'eager', ...props } = Astro.props;
---

<Image loading={loading} {...props as LocalImageProps | RemoteImageProps} />
